# üìä Structure des feuilles Excel - R√©f√©rence

## Vue d'ensemble

Ce document d√©crit la structure de chaque feuille Excel du syst√®me.

---

## üìã Feuille "Guides"

**Objectif :** Liste de tous les guides avec leurs coordonn√©es

### Colonnes

| Colonne | Type | Obligatoire | Description | Exemple |
|---------|------|-------------|-------------|---------|
| A - ID_Guide | Texte | ‚úÖ Oui | Identifiant unique (ne jamais changer) | G001, G002, G003 |
| B - Nom | Texte | ‚úÖ Oui | Nom de famille | DUPONT |
| C - Pr√©nom | Texte | ‚úÖ Oui | Pr√©nom | Marie |
| D - Email | Email | ‚úÖ Oui | Adresse email professionnelle | marie.dupont@email.fr |
| E - T√©l√©phone | Texte | ‚ùå Non | Num√©ro de t√©l√©phone | 0601020304 |

### R√®gles
- L'ID_Guide doit √™tre unique
- L'email doit √™tre valide pour l'envoi des plannings
- Ne pas supprimer les guides, ajouter "(INACTIF)" si n√©cessaire

### Exemple de donn√©es
```
ID_Guide | Nom      | Pr√©nom  | Email                    | T√©l√©phone
---------|----------|---------|--------------------------|------------
G001     | DUPONT   | Marie   | marie.dupont@email.fr    | 0601020304
G002     | MARTIN   | Pierre  | pierre.martin@email.fr   | 0605060708
G003     | BERNARD  | Sophie  | sophie.bernard@email.fr  | 0609101112
```

---

## üìÖ Feuille "Disponibilit√©s"

**Objectif :** Disponibilit√©s de chaque guide par date

### Colonnes

| Colonne | Type | Obligatoire | Description | Exemple |
|---------|------|-------------|-------------|---------|
| A - ID_Guide | Texte | ‚úÖ Oui | R√©f√©rence au guide | G001 |
| B - Date | Date | ‚úÖ Oui | Date concern√©e | 15/12/2025 |
| C - Disponible | Texte | ‚úÖ Oui | OUI ou NON (en majuscules) | OUI |
| D - Commentaire | Texte | ‚ùå Non | Raison si non disponible | Cong√©s |

### R√®gles
- Format de date : jj/mm/aaaa
- "Disponible" doit √™tre exactement "OUI" ou "NON" (majuscules)
- Une ligne par guide par jour
- Les lignes sont g√©n√©ralement cr√©√©es automatiquement via la macro `SaisirDisponibilites`

### Exemple de donn√©es
```
ID_Guide | Date       | Disponible | Commentaire
---------|------------|------------|-------------
G001     | 15/12/2025 | OUI        |
G001     | 16/12/2025 | NON        | Formation
G001     | 17/12/2025 | OUI        |
G002     | 15/12/2025 | OUI        |
G002     | 16/12/2025 | OUI        |
```

### Codes couleur automatiques
- üü¢ Vert : Disponible (OUI)
- üî¥ Rouge : Non disponible (NON)

---

## üèõÔ∏è Feuille "Visites"

**Objectif :** Catalogue de toutes les visites pr√©vues

### Colonnes

| Colonne | Type | Obligatoire | Description | Exemple |
|---------|------|-------------|-------------|---------|
| A - ID_Visite | Texte | ‚úÖ Oui | Identifiant unique de la visite | V001, V042 |
| B - Date | Date | ‚úÖ Oui | Date de la visite | 20/12/2025 |
| C - Heure_Debut | Heure | ‚úÖ Oui | Heure de d√©but | 10:00 |
| D - Heure_Fin | Heure | ‚úÖ Oui | Heure de fin | 12:00 |
| E - Mus√©e | Texte | ‚úÖ Oui | Nom du mus√©e ou lieu | Mus√©e du Louvre |
| F - Type_Visite | Texte | ‚ùå Non | Type de prestation | Visite guid√©e |
| G - Nombre_Visiteurs | Nombre | ‚ùå Non | Nombre de participants | 25 |

### R√®gles
- ID_Visite unique
- Format date : jj/mm/aaaa
- Format heure : hh:mm (24h)
- Heure_Fin doit √™tre apr√®s Heure_Debut
- La dur√©e est calcul√©e automatiquement pour les salaires

### Exemple de donn√©es
```
ID_Visite | Date       | Heure_Debut | Heure_Fin | Mus√©e              | Type_Visite    | Nb_Visiteurs
----------|------------|-------------|-----------|--------------------|-----------------|--------------
V001      | 15/12/2025 | 10:00       | 12:00     | Mus√©e du Louvre    | Visite guid√©e  | 20
V002      | 15/12/2025 | 14:00       | 16:00     | Mus√©e d'Orsay      | Visite guid√©e  | 15
V003      | 16/12/2025 | 10:00       | 12:00     | Centre Pompidou    | Atelier        | 12
```

---

## üìä Feuille "Planning"

**Objectif :** Attribution des guides aux visites (G√âN√âR√âE AUTOMATIQUEMENT)

### Colonnes

| Colonne | Type | Description | Exemple |
|---------|------|-------------|---------|
| A - ID_Visite | Texte | R√©f√©rence √† la visite | V001 |
| B - Date | Date | Date de la visite | 15/12/2025 |
| C - Heure | Texte | Plage horaire | 10:00 - 12:00 |
| D - Mus√©e | Texte | Lieu de la visite | Mus√©e du Louvre |
| E - ID_Guide | Texte | Guide assign√© (ou "NON ATTRIBU√â") | G001 |
| F - Guide_Nom | Texte | Nom complet du guide | Marie DUPONT |

### R√®gles
- ‚ö†Ô∏è Cette feuille est g√©n√©r√©e automatiquement par `GenererPlanningAutomatique`
- Ne pas modifier manuellement sauf pour corrections ponctuelles
- Utiliser `ModifierAttribution` pour changer un guide

### Codes couleur automatiques
- üîµ Bleu : Visite attribu√©e avec succ√®s
- üî¥ Rouge : Aucun guide disponible (√† traiter manuellement)

### Exemple de donn√©es
```
ID_Visite | Date       | Heure         | Mus√©e              | ID_Guide      | Guide_Nom
----------|------------|---------------|--------------------|--------------|--------------
V001      | 15/12/2025 | 10:00 - 12:00 | Mus√©e du Louvre    | G001         | Marie DUPONT
V002      | 15/12/2025 | 14:00 - 16:00 | Mus√©e d'Orsay      | G002         | Pierre MARTIN
V003      | 16/12/2025 | 10:00 - 12:00 | Centre Pompidou    | NON ATTRIBU√â | Aucun guide disponible
```

---

## üí∞ Feuille "Calculs_Paie"

**Objectif :** Calculs automatiques des salaires (G√âN√âR√âE AUTOMATIQUEMENT)

### Colonnes

| Colonne | Type | Description | Exemple |
|---------|------|-------------|---------|
| A - ID_Guide | Texte | Identifiant du guide | G001 |
| B - Nom_Complet | Texte | Nom et pr√©nom | Marie DUPONT |
| C - Nb_Visites | Nombre | Nombre total de visites | 8 |
| D - Montant_Salaire | Mon√©taire | Salaire calcul√© | 800,00 ‚Ç¨ |

### R√®gles
- G√©n√©r√©e par `CalculerVisitesEtSalaires`
- Calcul : Nombre d'heures √ó Tarif horaire (configur√© dans "Configuration")
- Une ligne de TOTAL en bas

### Exemple de donn√©es
```
ID_Guide | Nom_Complet      | Nb_Visites | Montant_Salaire
---------|------------------|------------|------------------
G001     | Marie DUPONT     | 8          | 800,00 ‚Ç¨
G002     | Pierre MARTIN    | 6          | 600,00 ‚Ç¨
G003     | Sophie BERNARD   | 5          | 500,00 ‚Ç¨
---------|------------------|------------|------------------
TOTAL    |                  | 19         | 1 900,00 ‚Ç¨
```

---

## üìÑ Feuille "Contrats"

**Objectif :** Historique des contrats g√©n√©r√©s

### Colonnes

| Colonne | Type | Description | Exemple |
|---------|------|-------------|---------|
| A - ID_Guide | Texte | Guide concern√© | G001 |
| B - Nom | Texte | Nom du guide | Marie DUPONT |
| C - Mois | Texte | P√©riode du contrat | d√©cembre 2025 |
| D - Dates_Visites | Texte | Liste des dates | 15/12, 17/12, 20/12 |
| E - Horaires | Texte | D√©tail des horaires | Multi-lignes |
| F - Total_Heures | Texte | Volume horaire total | 16.0 h |

### R√®gles
- Remplie automatiquement par `GenererContratGuide`
- Sert d'historique et de tra√ßabilit√©
- Les contrats Word/Excel sont g√©n√©r√©s √† part

### Exemple de donn√©es
```
ID_Guide | Nom          | Mois          | Dates_Visites        | Horaires        | Total_Heures
---------|--------------|---------------|----------------------|-----------------|-------------
G001     | Marie DUPONT | d√©cembre 2025 | 15/12, 17/12, 20/12  | (D√©taill√©)      | 16.0 h
```

---

## ‚öôÔ∏è Feuille "Configuration"

**Objectif :** Param√®tres globaux du syst√®me

### Structure

| Param√®tre | Valeur | Description |
|-----------|--------|-------------|
| Email_Expediteur | votre@email.fr | Email utilis√© pour l'envoi |
| Nom_Association | Votre Association | Nom complet de l'association |
| Tarif_Heure | 50 | Tarif horaire en euros |
| Notification_J7 | OUI | Activer notification 7 jours avant |
| Notification_J1 | OUI | Activer notification 1 jour avant |

### R√®gles
- Modifier les valeurs selon vos besoins
- Le tarif horaire est utilis√© pour tous les calculs de paie
- Les notifications peuvent √™tre d√©sactiv√©es (mettre "NON")

### Exemple
```
Param√®tre            | Valeur
---------------------|-------------------------
Email_Expediteur     | gestion@musees-guides.fr
Nom_Association      | Association des Guides de Mus√©e
Tarif_Heure          | 50
Notification_J7      | OUI
Notification_J1      | OUI
```

---

## üîÑ Flux de donn√©es

```
1. GUIDES (donn√©es ma√Ætres)
   ‚Üì
2. DISPONIBILIT√âS (saisies par les guides)
   ‚Üì
3. VISITES (saisies par l'administrateur)
   ‚Üì
4. PLANNING (g√©n√©r√© automatiquement)
   ‚Üì
5. CALCULS_PAIE (calcul√©s automatiquement)
   ‚Üì
6. CONTRATS (g√©n√©r√©s √† la demande)
```

---

## üìù Notes importantes

### Formats de date
- Toujours utiliser : jj/mm/aaaa
- Excel peut convertir automatiquement selon les param√®tres r√©gionaux

### Formats d'heure
- Toujours utiliser : hh:mm (24h)
- Exemple : 14:00 (et non 2:00 PM)

### Identifiants (ID)
- Utiliser un format coh√©rent : G001, G002... pour les guides
- V001, V002... pour les visites
- Ne jamais r√©utiliser un ID supprim√©

### Protection des donn√©es
- Prot√©ger la feuille "Disponibilit√©s" avec un mot de passe
- Limiter l'acc√®s √† "Calculs_Paie" (donn√©es sensibles)
- Sauvegarder r√©guli√®rement

---

## ‚úÖ Checklist de validation des donn√©es

Avant de g√©n√©rer le planning, v√©rifier :

- [ ] Tous les guides ont un email valide
- [ ] Les disponibilit√©s sont saisies pour la p√©riode concern√©e
- [ ] Les visites ont des dates/heures coh√©rentes
- [ ] Les ID sont uniques (pas de doublons)
- [ ] Le tarif horaire est configur√©
- [ ] Outlook est configur√© (pour les emails)

---

**üìå Ce document est une r√©f√©rence. Les feuilles sont cr√©√©es automatiquement avec les bons en-t√™tes par la macro `InitialiserApplication`.**
